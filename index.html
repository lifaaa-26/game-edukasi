<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kuis Sejarah Indonesia - Neon Gelap</title>
  <style>
    :root{
      --bg1: #050508;
      --bg2: #001021; /* deep blue */
      --bg3: #2b0036; /* deep purple */
      --card:#0f1115;
      --muted:#9aa0a6;
      --neon-blue: #39f;
      --neon-magenta: #ff2db8;
      --border:#222428;
      --success:#2ecc71;
      --danger:#ff6b6b;
      --warning:#f1c40f;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      min-height:100vh;
      font-family:Inter, "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      /* background gradient black - blue neon - purple */
      background: radial-gradient(circle at 10% 10%, rgba(57,153,255,0.06), transparent 10%),
                  linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 45%, var(--bg3) 100%);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:28px;
      color:#e6eef6;
    }

    .app { width:100%; max-width:760px; padding:18px; }

    /* neon frame */
    .card{
      position:relative;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:16px;
      padding:22px;
      box-shadow: 0 12px 40px rgba(0,0,0,0.7);
      overflow:visible;
      border:2px solid rgba(255,255,255,0.03);
    }
    /* neon outline using pseudo element */
    .card::before{
      content:"";
      position:absolute;
      inset:-6px;
      border-radius:20px;
      background: linear-gradient(90deg, rgba(57,153,255,0.08), rgba(255,45,184,0.08));
      filter: blur(10px);
      z-index:-2;
    }
    .card::after{
      content:"";
      position:absolute;
      inset:-2px;
      border-radius:18px;
      background: linear-gradient(90deg, var(--neon-blue), var(--neon-magenta));
      z-index:-1;
      opacity:0.18;
      mix-blend-mode:screen;
      pointer-events:none;
    }

    .header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:10px;
    }
    h1{ margin:0; font-size:20px; color:#fff; letter-spacing:0.2px }
    .meta{ color:var(--muted); font-size:13px }

    .start-center{ text-align:center; padding:10px 6px }
    input[name="player"]{
      width:72%;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,0.04);
      background:transparent;
      color:#e6eef6;
      outline:none;
      font-size:15px;
      margin-top:12px;
    }

    /* neon magenta start button */
    .btn {
      display:inline-block;
      padding:10px 18px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.05);
      background: linear-gradient(90deg, var(--neon-magenta), #ff6fbf);
      color:#0b0410;
      font-weight:800;
      cursor:pointer;
      margin-top:12px;
      box-shadow: 0 6px 18px rgba(255,45,184,0.14), 0 2px 6px rgba(0,0,0,0.6);
      transition: transform .14s ease, box-shadow .14s ease;
    }
    .btn:hover{ transform: translateY(-3px); box-shadow: 0 12px 30px rgba(255,45,184,0.2) }

    .btn.blue {
      background: linear-gradient(90deg, #38b0ff, #59d0ff);
      color:#021028;
      box-shadow: 0 6px 18px rgba(57,153,255,0.12);
    }
    .btn.ghost{
      background:transparent;
      color:var(--muted);
      border:1px solid rgba(255,255,255,0.03);
    }

    /* QUIZ */
    #quizScreen { display:none; margin-top:10px; }
    .top-row {
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; padding-bottom:12px; border-bottom:1px solid rgba(255,255,255,0.03); margin-bottom:14px;
    }
    .timer{ color:var(--neon-magenta); font-weight:800 }
    .progress{ color:var(--muted) }

    .question { font-size:18px; font-weight:800; margin:12px 0; color:#fff; text-shadow: 0 2px 6px rgba(0,0,0,0.8) }

    .options{ display:flex; flex-direction:column; gap:12px; margin-top:6px }

    /* option style with neon border highlight on hover */
    .opt{
      background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));
      border-radius:12px;
      padding:14px 16px;
      cursor:pointer;
      color:#eef6ff;
      font-weight:700;
      border:1px solid rgba(255,255,255,0.03);
      transition: transform .12s ease, box-shadow .12s ease, border-color .12s;
      position:relative;
      overflow:hidden;
    }
    .opt:hover{
      transform: translateY(-6px);
      box-shadow: 0 18px 40px rgba(0,0,0,0.6), 0 0 18px rgba(57,153,255,0.06);
      border-color: rgba(57,153,255,0.18);
    }
    .opt::after{
      content:"";
      position:absolute;
      inset:0;
      border-radius:12px;
      pointer-events:none;
      box-shadow: inset 0 0 40px rgba(57,153,255,0.01);
    }
    /* correct/wrong reveal colors */
    .opt.correct{ border-color: rgba(46,204,113,0.25); box-shadow: 0 8px 30px rgba(46,204,113,0.06); }
    .opt.wrong{ border-color: rgba(255,107,107,0.25); box-shadow: 0 8px 30px rgba(255,107,107,0.04); }

    /* result screen */
    #resultScreen{ display:none; text-align:center; margin-top:12px }
    .result-score{ font-size:20px; font-weight:800; color:#fff }

    /* notification center */
    .notif {
      position:fixed;
      left:50%;
      top:50%;
      transform:translate(-50%,-50%) scale(.95);
      padding:16px 28px;
      border-radius:12px;
      font-weight:800;
      font-size:20px;
      z-index:999;
      color:#eaf6ff;
      opacity:0; pointer-events:none;
      backdrop-filter: blur(4px);
    }
    .notif.show{ animation: pop .9s ease forwards; pointer-events:auto }
    @keyframes pop {
      0%{ opacity:0; transform:translate(-50%,-50%) scale(.8) }
      40%{ opacity:1; transform:translate(-50%,-50%) scale(1.06) }
      75%{ opacity:1; transform:translate(-50%,-58%) scale(1) }
      100%{ opacity:0; transform:translate(-50%,-66%) scale(.92) }
    }
    .notif.correct{ background: linear-gradient(90deg, rgba(57,153,255,0.06), rgba(255,45,184,0.04)); color: #bff0ff; border:1px solid rgba(57,153,255,0.12); }
    .notif.wrong{ background: linear-gradient(90deg, rgba(255,45,184,0.04), rgba(57,153,255,0.02)); color:#ffdfe9; border:1px solid rgba(255,45,184,0.12); }
    .notif.timeout{ background: linear-gradient(90deg, rgba(255,165,0,0.06), rgba(57,153,255,0.02)); color:#fff2dd; border:1px solid rgba(255,165,0,0.12); }

    .small{ font-size:13px; color:var(--muted) }

    .footer{ margin-top:12px; border-top:1px dashed rgba(255,255,255,0.03); padding-top:12px; display:flex; justify-content:space-between; color:var(--muted); font-size:13px }

    @media (max-width:680px){
      .app{ padding:12px }
      input[name="player"]{ width:100% }
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="card">
      <div class="header">
        <div>
          <h1>Kuis Sejarah Indonesia</h1>
          <div class="meta small">Tema: Sejarah ‚Äî 20 soal acak dari 100</div>
        </div>
        <div class="meta small">oleh: Kamu</div>
      </div>

      <!-- START -->
      <div id="startScreen" class="start-center">
        <p class="small">Masukkan nama untuk memulai kuis:</p>
        <input name="player" id="playerName" placeholder="Nama kamu..." autocomplete="off" />
        <div>
          <button id="startBtn" class="btn" onclick="startQuiz()">üöÄ Mulai Kuis</button>
        </div>
      </div>

      <!-- QUIZ -->
      <div id="quizScreen">
        <div class="top-row">
          <div class="timer" id="timer">‚è≥ Waktu: 15s</div>
          <div class="progress" id="progress">Soal 1 / 20</div>
        </div>

        <div id="questionCard">
          <div class="question" id="questionText">Pertanyaan muncul di sini</div>
          <div class="options" id="options"></div>
        </div>
      </div>

      <!-- RESULT -->
      <div id="resultScreen">
        <div class="result-score" id="resultText">Skor kamu</div>
        <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-top:12px">
          <button class="btn blue" onclick="showScore()">üìä Lihat Nilai</button>
          <button class="btn ghost" onclick="location.reload()">üîÑ Main Lagi</button>
        </div>
        <p id="scoreDetail" class="small" style="margin-top:12px; display:none"></p>
      </div>

      <div class="footer">
        <div>Durasi tiap soal: 15 detik</div>
        <div>Soal acak tiap permainan</div>
      </div>
    </div>
  </div>

  <div id="notif" class="notif"></div>

  <script>
    // ---------- 100 soal (Sejarah Indonesia) ----------
    const allQuestions = [
      { q:"Kapan Indonesia memproklamasikan kemerdekaan?", opts:["17 Agustus 1945","1 Juni 1945","10 November 1945","20 Mei 1908"], a:"17 Agustus 1945" },
      { q:"Siapa yang membacakan teks Proklamasi?", opts:["Soekarno","Mohammad Hatta","Sayuti Melik","Sudirman"], a:"Soekarno" },
      { q:"Di jalan mana teks Proklamasi dibacakan?", opts:["Pegangsaan Timur 56","Istana Negara","Lapangan Banteng","Gereja Katedral"], a:"Pegangsaan Timur 56" },
      { q:"Siapa yang mengetik naskah Proklamasi?", opts:["Sayuti Melik","Abdul Haris Nasution","Sutan Sjahrir","Suharto"], a:"Sayuti Melik" },
      { q:"Organisasi Budi Utomo didirikan tahun berapa?", opts:["1908","1905","1912","1928"], a:"1908" },
      { q:"Kapan Sumpah Pemuda diikrarkan?", opts:["1928","1926","1927","1930"], a:"1928" },
      { q:"Siapa pendiri Muhammadiyah?", opts:["KH Ahmad Dahlan","Ki Hajar Dewantara","HOS Tjokroaminoto","Sudirman"], a:"KH Ahmad Dahlan" },
      { q:"Tokoh yang dikenal sebagai Bapak Pendidikan Nasional adalah?", opts:["Ki Hajar Dewantara","Soekarno","Moh. Hatta","Tan Malaka"], a:"Ki Hajar Dewantara" },
      { q:"Piagam Jakarta berkaitan dengan?", opts:["Dasar negara (Pancasila)","Teks Proklamasi","Sumpah Pemuda","Perjanjian Giyanti"], a:"Dasar negara (Pancasila)" },
      { q:"BPUPKI dibentuk pada tanggal berapa?", opts:["29 Mei 1945","1 Juni 1945","29 April 1945","10 Juli 1945"], a:"29 April 1945" },
      { q:"Siapa proklamator kemerdekaan selain Soekarno?", opts:["Mohammad Hatta","Sutan Sjahrir","Tan Malaka","Sudirman"], a:"Mohammad Hatta" },
      { q:"Konferensi Asia-Afrika pertama diselenggarakan di kota?", opts:["Bandung","Jakarta","Surabaya","Yogyakarta"], a:"Bandung" },
      { q:"Tokoh yang mengeluarkan Sumpah Palapa adalah?", opts:["Gajah Mada","Raden Wijaya","Hayam Wuruk","Kertanegara"], a:"Gajah Mada" },
      { q:"Kerajaan Majapahit didirikan oleh?", opts:["Raden Wijaya","Gajah Mada","Hayam Wuruk","Kertanegara"], a:"Raden Wijaya" },
      { q:"Ibu kota Kerajaan Mataram Kuno berada di?", opts:["Medang","Kedu","Sunda","Kutai"], a:"Medang" },
      { q:"Perjanjian Linggarjati terjadi antara Indonesia dan?", opts:["Belanda","Portugal","Inggris","Prancis"], a:"Belanda" },
      { q:"Peristiwa Rengasdengklok terjadi pada tanggal?", opts:["16 Agustus 1945","17 Agustus 1945","15 Agustus 1945","18 Agustus 1945"], a:"16 Agustus 1945" },
      { q:"Apa nama peristiwa 10 November 1945 di Surabaya?", opts:["Pertempuran Surabaya","Agresi Militer Belanda","Serangan Umum 1 Maret","Bandung Lautan Api"], a:"Pertempuran Surabaya" },
      { q:"Siapa panglima yang terkenal dalam perang Diponegoro?", opts:["Pangeran Diponegoro","Gajah Mada","Raden Wijaya","Sultan Agung"], a:"Pangeran Diponegoro" },
      { q:"Sukarno memegang jabatan presiden keberapa?", opts:["Pertama","Kedua","Ketiga","Keempat"], a:"Pertama" },
      { q:"Apa nama badan yang menggantikan BPUPKI?", opts:["PPKI","KNIP","BKR","Badan Keamanan Rakyat"], a:"PPKI" },
      { q:"Nama perjanjian yang mengakui kedaulatan Indonesia pada 1949?", opts:["Konferensi Meja Bundar (KMB)","Perjanjian Linggarjati","Agresi Militer II","Perjanjian Renville"], a:"Konferensi Meja Bundar (KMB)" },
      { q:"Kapan Konferensi Meja Bundar (KMB) berlangsung?", opts:["1949","1948","1947","1946"], a:"1949" },
      { q:"G30S/PKI terjadi pada tahun?", opts:["1965","1955","1960","1970"], a:"1965" },
      { q:"Siapa panglima yang melawan VOC di Jawa terkenal?", opts:["Untung Surapati","Sunan Kalijaga","Diponegoro","Sultan Agung"], a:"Untung Surapati" },
      { q:"Bandung Lautan Api terjadi pada tahun?", opts:["1946","1945","1947","1950"], a:"1946" },
      { q:"Kapan Proklamasi dibacakan (tanggal lengkap)?", opts:["17 Agustus 1945","16 Agustus 1945","18 Agustus 1945","15 Agustus 1945"], a:"17 Agustus 1945" },
      { q:"Siapa yang dikenal dengan julukan 'Singa Betina dari Aceh'?", opts:["Cut Nyak Dien","Cut Nyak Meutia","R.A. Kartini","Dewi Sartika"], a:"Cut Nyak Dien" },
      { q:"Organisasi Sarekat Islam muncul pada awal abad ke?", opts:["20 (1900an)","19","18","21"], a:"20 (1900an)" },
      { q:"Siapa guru besar Soekarno dari kalangan pergerakan?", opts:["HOS Tjokroaminoto","Ki Hajar Dewantara","Sutan Sjahrir","Sudirman"], a:"HOS Tjokroaminoto" },
      { q:"Kerajaan Sriwijaya berbasis di pulau?", opts:["Sumatra","Jawa","Kalimantan","Sulawesi"], a:"Sumatra" },
      { q:"Ibukota Sriwijaya berada di?", opts:["Palembang","Jakarta","Surabaya","Medan"], a:"Palembang" },
      { q:"Perjanjian Giyanti membagi kerajaan Mataram menjadi?", opts:["Yogyakarta & Surakarta","Tiga bagian","Satu kerajaan","Empat bagian"], a:"Yogyakarta & Surakarta" },
      { q:"Siapa tokoh yang menulis 'Indonesia Menggugat'?", opts:["Ernest Douwes Dekker","Sutan Takdir Alisjahbana","W.S. Rendra","Soekarno"], a:"Ernest Douwes Dekker" },
      { q:"Organisasi yang lahir sekitar 1908 selain Budi Utomo?", opts:["Sarekat Islam","Indische Partij","Partai Komunis Indonesia","Muhammadiyah"], a:"Sarekat Islam" },
      { q:"Siapa yang mengajak Soekarno-Hatta memproklamasikan kemerdekaan setelah Jepang menyerah?", opts:["Radjiman Wedyodiningrat","Sutan Sjahrir","Soekanto","Achmad Soebardjo"], a:"Radjiman Wedyodiningrat" },
      { q:"R.A. Kartini memperjuangkan?", opts:["Emansipasi wanita","Pergerakan kemerdekaan","Pertanian modern","Pendidikan militer"], a:"Emansipasi wanita" },
      { q:"Apa lembaga yang menyusun UUD 1945 pada awal kemerdekaan?", opts:["PPKI","BPUPKI","KNIP","BKR"], a:"PPKI" },
      { q:"Perbedaan utama UUD 1945 vs UUDS 1950?", opts:["UUDS parlementer (tata cara berbeda)","Satu dibuat oleh Belanda","UUDS 1950 proklamasi","Tidak ada perbedaan"], a:"UUDS parlementer (tata cara berbeda)" },
      { q:"Siapa tokoh Trikora (Irian Barat)?", opts:["Soekarno","Soeharto","Hatta","Sudirman"], a:"Soekarno" },
      { q:"Peristiwa Serangan Umum 1 Maret 1949 terjadi di?", opts:["Solo (Surakarta)","Yogyakarta","Jakarta","Bandung"], a:"Solo (Surakarta)" },
      { q:"Apa tujuan Sumpah Palapa?", opts:["Mempersatukan Nusantara","Memisahkan Nusantara","Menyerang Majapahit","Mendirikan kerajaan baru"], a:"Mempersatukan Nusantara" },
      { q:"Tanggal Rengasdengklok (peristiwa penting) adalah?", opts:["16 Agustus 1945","17 Agustus 1945","15 Agustus 1945","18 Agustus 1945"], a:"16 Agustus 1945" },
      { q:"Siapa presiden kedua RI?", opts:["Soeharto","Soekarno","BJ Habibie","Abdurrahman Wahid"], a:"Soeharto" },
      { q:"Kapan era Orde Baru dimulai (de facto)?", opts:["1966","1965","1970","1959"], a:"1966" },
      { q:"Perjanjian Linggarjati terjadi pada tahun?", opts:["1947","1946","1948","1949"], a:"1947" },
      { q:"Siapa tokoh PKI Madiun 1948?", opts:["Musso","Tan Malaka","Sukarno","Sutan Sjahrir"], a:"Musso" },
      { q:"Siapa pahlawan yang memimpin perlawanan di Maluku 1817 (Pattimura)?", opts:["Pattimura","Teuku Umar","Diponegoro","Cut Nyak Dien"], a:"Pattimura" },
      { q:"Siapa Bapak Koperasi Indonesia?", opts:["Mohammad Hatta","Soekarno","Sudirman","Ki Hajar Dewantara"], a:"Mohammad Hatta" },
      { q:"Peristiwa 'Bandung Lautan Api' dipimpin oleh?", opts:["Pejuang lokal & Bung Tomo populer di Surabaya","Bung Tomo","Soekarno","Sutan Sjahrir"], a:"Pejuang lokal & Bung Tomo populer di Surabaya" },
      { q:"Siapa pahlawan nasional dari Sulawesi (Sam Ratulangi)?", opts:["Sam Ratulangi","Pattimura","Teuku Umar","Sukarno"], a:"Sam Ratulangi" },
      { q:"Tanggal peringatan Sumpah Pemuda setiap tahun?", opts:["28 Oktober","27 Oktober","28 November","28 September"], a:"28 Oktober" },
      { q:"Apa nama VOC bubar tahun?", opts:["1799","1800","1700","1815"], a:"1799" },
      { q:"Apa sistem tanam paksa Belanda disebut?", opts:["Cultuurstelsel","Tanam Paksu","Tanam Swadaya","Kultuur"], a:"Cultuurstelsel" },
      { q:"Siapa yang mengetik naskah proklamasi?", opts:["Sayuti Melik","Sutan Sjahrir","Soekarno","Hatta"], a:"Sayuti Melik" },
      { q:"Perjanjian yang mengakhiri agresi Belanda kedua & pengakuan kedaulatan?", opts:["KMB (Konferensi Meja Bundar)","Linggarjati","Renville","Roem-Royen"], a:"KMB (Konferensi Meja Bundar)" },
      { q:"Siapa tokoh pendidikan yang mendirikan Taman Siswa?", opts:["Ki Hajar Dewantara","KH Ahmad Dahlan","R.A. Kartini","Soekarno"], a:"Ki Hajar Dewantara" },
      { q:"Siapa yang memproklamasikan kemerdekaan bersama Soekarno?", opts:["Mohammad Hatta","Sutan Sjahrir","Tan Malaka","Sudirman"], a:"Mohammad Hatta" },
      { q:"Siapa yang memimpin Pertempuran Surabaya (pidato Arek-arek Suroboyo)?", opts:["Bung Tomo","Bung Tomo","Sudirman","Soekarno"], a:"Bung Tomo" },
      { q:"Siapa wakil presiden pertama RI?", opts:["Mohammad Hatta","Sutan Sjahrir","Sudirman","Soeharto"], a:"Mohammad Hatta" },
      { q:"Siapa yang menjadi Presiden RI setelah Soeharto (1998)?", opts:["BJ Habibie","Abdurrahman Wahid","Megawati","Susilo Bambang Yudhoyono"], a:"BJ Habibie" },
      { q:"Siapa presiden ke-5 RI?", opts:["Megawati Soekarnoputri","BJ Habibie","Abdurrahman Wahid","Soeharto"], a:"Megawati Soekarnoputri" },
      { q:"Siapa presiden ke-6 RI?", opts:["Susilo Bambang Yudhoyono","Megawati","BJ Habibie","Gus Dur"], a:"Susilo Bambang Yudhoyono" },
      { q:"Siapa presiden ke-7 RI?", opts:["Joko Widodo","Prabowo Subianto","Megawati","SBY"], a:"Joko Widodo" },
      { q:"Organisasi PETA dibentuk pada masa siapa?", opts:["Jepang (masa pendudukan)","Belanda","Portugal","VOC"], a:"Jepang (masa pendudukan)" },
      { q:"Apa tujuan Sumpah Pemuda 1928?", opts:["Menegaskan persatuan Indonesia","Mendirikan partai politik","Menegaskan agama bersama","Mendirikan kerajaan"], a:"Menegaskan persatuan Indonesia" },
      { q:"Apa nama perjanjian yang menempatkan Belanda & Indonesia pasca-PD II (seperti Renville/Linggarjati)?", opts:["Linggarjati / Renville (berbagai tahapan)","KMB","Perjanjian Giyanti","Perjanjian Tuntang"], a:"Linggarjati / Renville (berbagai tahapan)" },
      { q:"Siapa yang memimpin perlawanan Pangeran Diponegoro?", opts:["Pangeran Diponegoro","Sultan Agung","Untung Surapati","Raden Wijaya"], a:"Pangeran Diponegoro" },
      { q:"Siapa tokoh dipenjara di Boven Digoel (contoh tokoh)?", opts:["Tan Malaka","Sukarno","Hatta","Sutan Sjahrir"], a:"Tan Malaka" },
      { q:"Apa nama pemberontakan 1948 yang dipimpin Musso?", opts:["Madiun (PKI) 1948","PRRI","Permesta","G30S"], a:"Madiun (PKI) 1948" },
      { q:"Apa nama perlawanan rakyat Aceh melawan Belanda awal abad 20?", opts:["Perang Aceh","Perang Jawa","Perang Padri","Perang Bali"], a:"Perang Aceh" },
      { q:"Siapa pahlawan wanita dari Maluku bernama Martha Christina Tiahahu terkait perjuangan?", opts:["Martha Christina Tiahahu","Cut Nyak Dien","Kartini","Dewi Sartika"], a:"Martha Christina Tiahahu" },
      { q:"Siapa tokoh yang memprakarsai Indische Partij (pergerakan di Belanda)?", opts:["Ernest Douwes Dekker dkk","Sutan Sjahrir","Soekarno","Hatta"], a:"Ernest Douwes Dekker dkk" }
    ];
    // ensure we have at least 100; if shorter, we can reuse and expand later.
    // For safety ensure count >= 100: if not, duplicate with small variation
    while(allQuestions.length < 100){
      const idx = allQuestions.length % allQuestions.length;
      allQuestions.push(Object.assign({}, allQuestions[idx]));
    }

    // ---------- settings ----------
    const QUESTIONS_COUNT = 20; // display 20 per game

    // state
    let questions = [];
    let current = 0;
    let score = 0;
    let player = "";
    let timeLeft = 15;
    let timer = null;

    // elements
    const startScreen = document.getElementById('startScreen');
    const quizScreen = document.getElementById('quizScreen');
    const resultScreen = document.getElementById('resultScreen');
    const playerInput = document.getElementById('playerName');
    const questionText = document.getElementById('questionText');
    const optionsDiv = document.getElementById('options');
    const timerEl = document.getElementById('timer');
    const progressEl = document.getElementById('progress');
    const notif = document.getElementById('notif');
    const resultText = document.getElementById('resultText');
    const scoreDetail = document.getElementById('scoreDetail');
    const startBtn = document.getElementById('startBtn');

    // notification helper
    function showNotif(type, text){
      notif.className = 'notif '+type+' show';
      notif.textContent = text;
      setTimeout(()=>{ notif.className='notif'; notif.textContent=''; }, 900);
    }

    // pick QUESTIONS_COUNT random unique questions from allQuestions
    function pickRandomQuestions(){
      const pool = allQuestions.slice(); // copy
      // shuffle pool (Fisher-Yates)
      for(let i=pool.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [pool[i], pool[j]] = [pool[j], pool[i]];
      }
      return pool.slice(0, Math.min(QUESTIONS_COUNT, pool.length));
    }

    // start quiz
    function startQuiz(){
      const name = playerInput.value.trim();
      if(!name){
        showNotif('wrong','‚ö†Ô∏è Masukkan nama dulu!');
        return;
      }
      player = name;
      // pick randomized set per player/game
      questions = pickRandomQuestions();
      current = 0;
      score = 0;
      // UI
      startScreen.style.display = 'none';
      resultScreen.style.display = 'none';
      quizScreen.style.display = 'block';
      scoreDetail.style.display = 'none';
      // visual: change start button color to magenta (already), but we ensure focus out
      startBtn.blur();
      renderQuestion();
      startTimer();
    }

    function startTimer(){
      timeLeft = 15;
      timerEl.textContent = `‚è≥ Waktu: ${timeLeft}s`;
      clearInterval(timer);
      timer = setInterval(()=>{
        timeLeft--;
        timerEl.textContent = `‚è≥ Waktu: ${timeLeft}s`;
        if(timeLeft <= 0){
          clearInterval(timer);
          showNotif('timeout','‚è∞ Waktu Habis!');
          // small delay then next
          setTimeout(()=> nextQuestion(), 800);
        }
      },1000);
    }

    function renderQuestion(){
      const q = questions[current];
      progressEl.textContent = `Soal ${current+1} / ${questions.length}`;
      questionText.textContent = `‚ùì ${q.q}`;
      optionsDiv.innerHTML = '';
      // shuffle options copy
      const opts = q.opts.slice();
      for(let i=opts.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [opts[i], opts[j]] = [opts[j], opts[i]];
      }
      opts.forEach(opt=>{
        const el = document.createElement('div');
        el.className = 'opt';
        el.textContent = opt;
        el.onclick = ()=> handleAnswerClick(el, opt);
        optionsDiv.appendChild(el);
      });
    }

    // handle click: show immediate notification and highlight chosen, then next
    function handleAnswerClick(el, selected){
      clearInterval(timer);
      const q = questions[current];
      // disable clicks temporarily
      Array.from(optionsDiv.children).forEach(c => c.style.pointerEvents = 'none');
      if(selected === q.a){
        score += 5;
        el.classList.add('correct');
        showNotif('correct','‚úÖ Benar!');
      } else {
        el.classList.add('wrong');
        // highlight correct option
        Array.from(optionsDiv.children).forEach(c=>{
          if(c.textContent === q.a) c.classList.add('correct');
        });
        showNotif('wrong','‚ùå Salah!');
      }
      setTimeout(()=> nextQuestion(), 900);
    }

    function nextQuestion(){
      current++;
      if(current < questions.length){
        renderQuestion();
        startTimer();
      } else {
        endQuiz();
      }
    }

    function endQuiz(){
      clearInterval(timer);
      quizScreen.style.display = 'none';
      resultScreen.style.display = 'block';
      resultText.textContent = `üéä ${player}, skor kamu: ${score} dari ${questions.length*5} poin.`;
      scoreDetail.style.display = 'none';
      // save history (localStorage)
      try{
        const hist = JSON.parse(localStorage.getItem('quizHistory')||'[]');
        hist.push({ name: player, score, max: questions.length*5, percent: Math.round((score/(questions.length*5))*100), date: (new Date()).toISOString() });
        localStorage.setItem('quizHistory', JSON.stringify(hist.slice(-100)));
      }catch(e){}
    }

    function showScore(){
      const max = questions.length * 5;
      const nilai = (score / max) * 100;
      let grade = '';
      if(nilai >= 85) grade = 'Sangat Baik';
      else if(nilai >= 70) grade = 'Baik';
      else if(nilai >= 50) grade = 'Cukup';
      else grade = 'Perlu Latihan';
      scoreDetail.style.display = 'block';
      scoreDetail.textContent = `Nilai: ${nilai.toFixed(0)} | Kategori: ${grade}`;
    }

    // expose functions
    window.startQuiz = startQuiz;
    window.showScore = showScore;

    // allow Enter to start
    playerInput.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') startQuiz(); });

  </script>
</body>
</html>
